<!-- index.html -->
<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Weather TopBar Demo</title>
<style>
  :root{--glass: rgba(255,255,255,0.08);--glass-border: rgba(255,255,255,0.12)}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; background: linear-gradient(#2b6da6,#9ad4f5); height:100vh; color:#fff}
  .topbar{max-width:720px;margin:28px auto;padding:12px 18px;border-radius:28px;background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));backdrop-filter: blur(8px);display:flex;align-items:center;gap:12px;border:1px solid var(--glass-border)}
  .icon{width:28px;height:28px;display:inline-flex;align-items:center;justify-content:center;cursor:pointer}
  .search-input{flex:1;background:transparent;border:none;outline:none;color:#fff;font-size:16px}
  .heart.fav{filter: drop-shadow(0 1px 0 rgba(0,0,0,0.2))}
  .menu{display:flex;gap:8px;align-items:center}
  .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:28px;background:#111a; color:#fff;padding:8px 12px;border-radius:8px;display:none}
</style>
</head>
<body>
  <div class="topbar" role="toolbar" aria-label="Top bar">
    <div class="icon" id="searchBtn" title="Search" aria-label="Search" tabindex="0">üîç</div>
    <input id="searchInput" class="search-input" placeholder="Search city" aria-label="Search city" />
    <div class="menu" aria-hidden="false">
      <div class="icon" id="saveBtn" title="Save city" aria-label="Save city" tabindex="0">‚ô°</div>
      <div class="icon" id="menuBtn" title="Menu" aria-label="Menu" tabindex="0">‚ãÆ</div>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

<script>
  // simple demo logic
  const saveBtn = document.getElementById('saveBtn')
  const searchInput = document.getElementById('searchInput')
  const toast = document.getElementById('toast')

  function showToast(msg){
    toast.textContent = msg
    toast.style.display = 'block'
    clearTimeout(window._t)
    window._t = setTimeout(()=> toast.style.display = 'none', 1700)
  }

  function savedCities(){
    return JSON.parse(localStorage.getItem('savedCities') || '[]')
  }

  function isSaved(name){
    return savedCities().includes(name)
  }

  function toggleSave(name){
    if(!name) return showToast('Enter a city first')
    const arr = savedCities()
    const idx = arr.indexOf(name)
    if(idx>=0){
      arr.splice(idx,1)
      localStorage.setItem('savedCities', JSON.stringify(arr))
      saveBtn.textContent = '‚ô°' // outline
      showToast(`${name} removed`)
    } else {
      arr.push(name)
      localStorage.setItem('savedCities', JSON.stringify(arr))
      saveBtn.textContent = '‚ù§Ô∏è' // filled
      showToast(`${name} saved`)
    }
  }

  // init saved UI
  function refreshSaveButton(){
    const q = searchInput.value.trim()
    saveBtn.textContent = isSaved(q) ? '‚ù§Ô∏è' : '‚ô°'
  }

  // fake fetch stub: replace this with real API call
  async function fetchWeather(city){
    // simulate network
    await new Promise(r=>setTimeout(r,400))
    return {city, temp: 28, desc: 'Sunny'}
  }

  async function onSearchSubmit(){
    const city = searchInput.value.trim()
    if(!city) return showToast('Type a city name')
    // you can call real API here
    showToast('Searching...')
    try{
      const data = await fetchWeather(city)
      showToast(`Found: ${data.city} ‚Ä¢ ${data.temp}¬∞`)
      refreshSaveButton()
      // show results UI (not in this snippet)
    }catch(e){
      showToast('Search failed')
    }
  }

  // events
  searchInput.addEventListener('keydown', e=>{
    if(e.key === 'Enter') onSearchSubmit()
    else setTimeout(refreshSaveButton, 50)
  })
  document.getElementById('searchBtn').addEventListener('click', onSearchSubmit)
  saveBtn.addEventListener('click', ()=> toggleSave(searchInput.value.trim()))
  // keyboard accessibility
  saveBtn.addEventListener('keydown', e => { if(e.key === 'Enter') toggleSave(searchInput.value.trim()) })

  // prefill for demo
  searchInput.value = 'Mumbai'
  refreshSaveButton()
</script>
</body>
</html>
